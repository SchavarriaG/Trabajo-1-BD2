set serveroutput on

-- creamos la tabla de prueba
CREATE TABLE proveedor(
    codpv NUMBER(8) PRIMARY KEY,
    nompv VARCHAR2(10) NOT NULL );

INSERT INTO proveedor VALUES(10, 'Lisy'); 
INSERT INTO proveedor VALUES(20, 'Kirsty');
INSERT INTO proveedor VALUES(30, 'Bjorky');
INSERT INTO proveedor VALUES(40, 'Wimpy');
INSERT INTO proveedor VALUES(50, 'Chucky');
INSERT INTO proveedor VALUES(60, 'Chubby');
    
CREATE TABLE venta(
    idv NUMBER(8) PRIMARY KEY,
    codpv NUMBER(8) REFERENCES proveedor NOT NULL,
    codproducto NUMBER(8) NOT NULL
);

INSERT INTO venta VALUES(3	,10	,	1); 
INSERT INTO venta VALUES(5	,10	,	2); 
INSERT INTO venta VALUES(7	,10	,	5); 
INSERT INTO venta VALUES(17	,10	,	2); 
INSERT INTO venta VALUES(8	,20	,	2); 
INSERT INTO venta VALUES(1	,20	,	1); 
INSERT INTO venta VALUES(9	,20	,	5); 
INSERT INTO venta VALUES(31	,20	,	1); 
INSERT INTO venta VALUES(33	,20	,	1); 
INSERT INTO venta VALUES(10	,30	,	1); 
INSERT INTO venta VALUES(11	,30	,	2); 
INSERT INTO venta VALUES(12	,40	,	2); 
INSERT INTO venta VALUES(2	,40	,	1); 
INSERT INTO venta VALUES(22	,40	,	2); 
INSERT INTO venta VALUES(28	,50	,	2); 
INSERT INTO venta VALUES(21	,50	,	1); 
INSERT INTO venta VALUES(29	,50	,	5); 
INSERT INTO venta VALUES(99	,60	,	2); 


CREATE OR REPLACE PROCEDURE buscar (n IN NUMBER) IS
begin

DBMS_OUTPUT.PUT_LINE(n);
end;
/

drop table tablaaux;
create table tablaaux as 
select distinct nompv, proveedor.codpv, venta.codproducto 
from proveedor, venta 
where proveedor.codpv = venta.codpv 
order by codpv;

COLUMN codprod FORMAT A50
create table tablaaux2 as 
SELECT nompv, LISTAGG(codproducto, ',') WITHIN GROUP (ORDER BY codproducto) AS codprod
FROM   tablaaux
GROUP BY nompv;







--DECLARE
--contador NUMBER(8) := 20;

--DBMS_OUTPUT.PUT_LINE('Hola mundo ' || contador);
--exception
--  when no_data_found then
--    ; 